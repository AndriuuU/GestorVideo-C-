@page "/devices"
@using VideoMatrix.Models
@using VideoMatrix.Services
@inject DeviceService DeviceService

<h3>Dispositivos</h3>

<div class="device-grid">
    <h4>Transmisores</h4>
    <div class="grid">
        @if (transmitters != null)
        {
            @foreach (var transmitter in transmitters)
            {
                <div class="grid-item">
                    <h5>@transmitter.Name (@transmitter.IpAddress)</h5>
                    @if (transmitter.Status == DeviceStatus.On)
                    {
                        <img src="@transmitter.ImageUrl" alt="Transmitter Image" />
                    }
                    else
                    {
                        <p>Estado: @transmitter.Status</p>
                    }
                </div>
            }
        }
        else
        {
            <p>Cargando...</p>
        }
    </div>

    <h4>Receptores</h4>
    <div class="grid">
        @if (receivers != null)
        {
            @foreach (var receiver in receivers)
            {
                <div class="grid-item">
                    <h5>@receiver.Name (@receiver.IpAddress)</h5>
                    @if (receiver.Status == DeviceStatus.On)
                    {
                        <img src="@receiver.ImageUrl" alt="Receiver Image" />
                    }
                    else
                    {
                        <p>Estado: @receiver.Status</p>
                    }
                </div>
            }
        }
        else
        {
            <p>Cargando...</p>
        }
    </div>
</div>

@code {
    private List<Transmitter> transmitters;
    private List<Receiver> receivers;

    protected override async Task OnInitializedAsync()
    {
        transmitters = await DeviceService.GetTransmittersAsync();
        receivers = await DeviceService.GetReceiversAsync();
    }
}
